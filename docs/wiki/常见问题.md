# 常见问题

本页面收集了 Ava 使用中的常见问题和解决方案。

---

## 连接问题

### 设备无法被 Home Assistant 发现

**可能原因：**
1. 设备和 HA 不在同一网络
2. 防火墙阻止了连接
3. Ava 服务未启动

**解决方案：**
1. 确保设备和 HA 连接到同一 WiFi
2. 检查路由器防火墙设置，开放 6053 端口
3. 在 Ava 中启动语音卫星服务
4. 尝试手动添加设备（输入 IP 地址）

### 连接后频繁断开

**可能原因：**
1. 网络不稳定
2. Ava 被系统杀死
3. 电池优化限制

**解决方案：**
1. 检查 WiFi 信号强度
2. 关闭 Ava 的电池优化
3. 将 Ava 加入系统白名单
4. 保持设备充电状态

### 如何关闭电池优化

1. 打开手机 **设置**
2. 进入 **电池** 或 **应用管理**
3. 找到 **Ava**
4. 选择 **不限制** 或 **允许后台运行**

---

## 语音问题

### Ava 听不到我说话

**检查清单：**
- [ ] 麦克风权限已授予
- [ ] 静音模式已关闭
- [ ] 设备音量不是静音
- [ ] 唤醒词设置正确

**解决方案：**
1. 去手机设置检查麦克风权限
2. 在 Ava 设置中关闭静音
3. 按音量键调高音量
4. 尝试更换唤醒词

### 唤醒词识别不准确

**可能原因：**
1. 环境太嘈杂
2. 发音不标准
3. 距离太远

**解决方案：**
1. 在安静环境使用
2. 清晰、缓慢地说出唤醒词
3. 靠近设备说话
4. 尝试其他唤醒词

### 语音识别结果不对

这通常是 Home Assistant 端的问题：
1. 检查 HA 的语音助手配置
2. 确保 Whisper 等组件正常
3. 检查网络延迟
4. 尝试说得更清楚

### 没有语音回复

**检查清单：**
- [ ] HA 的 TTS 配置正确
- [ ] Ava 音量不是静音
- [ ] 网络连接正常

---

## 显示问题

### 屏保不显示

**检查清单：**
- [ ] 屏保开关已打开
- [ ] 悬浮窗权限已授予
- [ ] 超时时间已设置
- [ ] 屏保 URL 正确（如使用网页屏保）

**解决方案：**
1. 在设置中开启屏保
2. 授予悬浮窗权限
3. 设置合适的超时时间
4. 尝试使用内置小米画报

### 天气不显示

**检查清单：**
- [ ] 天气开关已打开
- [ ] 已选择城市
- [ ] 选择的是中国城市
- [ ] 网络连接正常

**注意：** 天气功能仅支持中国城市！

### 通知场景不显示

**检查清单：**
- [ ] 悬浮窗权限已授予
- [ ] 场景 ID 正确
- [ ] HA 服务调用成功

**解决方案：**
1. 检查悬浮窗权限
2. 确认场景 ID 拼写正确
3. 在 HA 开发者工具中测试服务调用

### 浏览器显示空白

**可能原因：**
1. URL 不正确
2. 网络问题
3. 渲染问题

**解决方案：**
1. 检查 URL 是否可访问
2. 检查网络连接
3. 尝试切换渲染模式（硬件/软件）

---

## 权限问题

### 需要哪些权限

| 权限 | 用途 | 必需 |
|------|------|------|
| 麦克风 | 语音输入 | ✅ |
| 悬浮窗 | 显示屏保、通知等 | ✅ |
| 前台服务 | 保持服务运行 | ✅ |
| 摄像头 | 拍照和视频 | ❌ |
| 蓝牙 | 在场检测 | ❌ |
| 位置 | 蓝牙扫描 | ❌ |

### 如何授予悬浮窗权限

1. 打开手机 **设置**
2. 进入 **应用** → **Ava**
3. 找到 **权限** 或 **特殊权限**
4. 开启 **显示在其他应用上层** 或 **悬浮窗**

### 权限被拒绝后如何重新授予

1. 打开手机 **设置**
2. 进入 **应用** → **Ava** → **权限**
3. 手动开启需要的权限

---

## 性能问题

### 设备发热严重

**可能原因：**
1. 屏幕长时间亮着
2. 视频流帧率太高
3. 后台任务过多

**解决方案：**
1. 降低屏幕亮度
2. 使用屏保（会移动内容）
3. 降低视频帧率和分辨率
4. 关闭不需要的功能

### 电池消耗快

**解决方案：**
1. 保持设备充电
2. 开启光照感应关屏
3. 降低屏幕亮度
4. 减少后台刷新频率

### 应用卡顿

**解决方案：**
1. 重启 Ava 服务
2. 清除应用缓存
3. 减少同时开启的功能
4. 检查设备存储空间

---

## 更新问题

### 如何更新 Ava

**自动更新：**
Ava 会每小时检查更新，有新版本时自动下载安装。

**手动更新：**
1. 访问 GitHub Releases
2. 下载最新 APK
3. 安装覆盖旧版本

### 更新后设置丢失

设置存储在应用数据中，正常更新不会丢失。如果丢失：
1. 检查是否卸载后重装（会清除数据）
2. 重新配置设置

---

## Android 系统兼容性

### MIUI/小米系统

**常见问题：**
- 后台服务被杀死
- 悬浮窗权限被限制
- 自启动被禁止

**解决方案：**
1. 设置 → 应用 → Ava → 省电策略 → 无限制
2. 设置 → 应用 → Ava → 权限 → 后台弹出界面 → 允许
3. 设置 → 应用 → 自启动管理 → 允许 Ava
4. 将 Ava 加入电池优化白名单

### 华为/荣耀 EMUI/HarmonyOS

**常见问题：**
- 应用被电池管理杀死
- 悬浮窗权限需要额外设置

**解决方案：**
1. 设置 → 应用 → 应用启动管理 → Ava → 允许手动管理
2. 设置 → 电池 → 应用启动管理 → Ava → 全部允许
3. 设置 → 应用 → Ava → 权限 → 悬浮窗 → 允许

### OPPO/Realme ColorOS

**常见问题：**
- 后台运行受限
- 通知权限需要单独开启

**解决方案：**
1. 设置 → 电池 → 更多电池设置 → 优化策略 → Ava → 不优化
2. 设置 → 应用 → Ava → 权限 → 允许后台运行
3. 设置 → 通知与状态栏 → Ava → 允许通知

### vivo/iQOO OriginOS

**常见问题：**
- 后台服务被限制
- 自启动需要手动开启

**解决方案：**
1. 设置 → 电池 → 后台耗电管理 → Ava → 允许后台高耗电
2. 设置 → 应用与权限 → 自启动管理 → Ava → 允许

### 三星 One UI

**常见问题：**
- 电池优化杀死后台服务

**解决方案：**
1. 设置 → 应用 → Ava → 电池 → 不受限制
2. 设置 → 电池和设备维护 → 电池 → 后台使用限制 → 从不自动关闭中添加 Ava

### 原生 Android/Pixel

通常问题较少，但仍需：
1. 设置 → 应用 → Ava → 电池 → 不受限制

### 其他品牌/杂牌系统

大多数问题都是权限问题，通用解决方案：

**后台运行权限：**
1. 设置 → 应用管理 → Ava → 电池/省电 → 不限制/不优化
2. 设置 → 电池 → 后台管理 → 允许 Ava 后台运行

**悬浮窗权限：**
1. 设置 → 应用管理 → Ava → 权限 → 悬浮窗/显示在其他应用上层
2. 部分系统可能在“特殊权限”中

**自启动权限：**
1. 设置 → 应用管理 → 自启动管理 → 允许 Ava
2. 部分系统可能在“安全中心”或“手机管家”中

**通用技巧：**
- 将 Ava 加入电池优化白名单
- 将 Ava 锁定在最近任务中（下拉卡片点锁定图标）
- 保持设备充电状态

---

## 技术问题

### WebView 崩溃

**可能原因：**
1. WebView 版本过旧
2. 内存不足
3. 网页内容过于复杂

**解决方案：**
1. 更新系统 WebView（通过 Play 商店）
2. 切换到软件渲染模式
3. Ava 内置崩溃恢复机制，会自动重建 WebView

### 场景不加载

**可能原因：**
1. 网络无法访问 GitHub
2. 缓存损坏

**解决方案：**
1. 检查网络连接
2. 重启 Ava 应用
3. 场景会缓存到本地，下次启动时优先从缓存加载

### 蓝牙中继器不工作

**检查清单：**
- [ ] 蓝牙权限已授予
- [ ] 位置权限已授予（Android 要求）
- [ ] 蓝牙已开启
- [ ] 设备卡槽已配置

---

## 关于开源

### 为什么部分代码未开源

Ava 是一个个人项目，最初只是为了自己使用。蓝牙中继器等部分功能的代码未开源，以防止被抄袭。

其他所有功能的代码均可在 GitHub 上查看。

### 可以贡献代码吗

欢迎提交 Pull Request！但说实话，贡献代码的人很少。这个项目并不图让更多人喜欢，实际上一开始只是为了自己。

### 如何报告问题

1. 访问 GitHub Issues
2. 描述问题现象
3. 提供设备信息和日志
4. 附上截图（如有）

**GitHub Issues**: https://github.com/knoop7/Ava/issues

---

## 其他问题

### 如何重启服务

1. 进入 **设置** → **语音卫星**
2. 点击 **停止服务**
3. 等待几秒
4. 点击 **启动服务**

### 如何查看日志

使用 ADB 查看日志：
```bash
adb logcat | grep -i ava
```

### 如何报告问题

1. 访问 GitHub Issues
2. 描述问题现象
3. 提供设备信息和日志
4. 附上截图（如有）

**GitHub Issues**: https://github.com/knoop7/Ava/issues

---

*返回 [首页](Home.md)*
