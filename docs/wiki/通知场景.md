# 通知场景

通知场景是 Ava 的特色功能，在智能家居事件发生时显示精美的全屏动画通知。

---

## 概述

通知场景显示全屏动画通知，包括：
- 极光动画背景
- 图标动画
- 标题和描述文字
- 自定义主题颜色

---

## 工作原理

### 场景加载

场景根据语言从网络加载：
- 中文：`scenes_zh.json`
- 英文：`scenes_en.json`

场景文件托管在 GitHub 上，Ava 启动时自动下载。

### 触发场景

通过 Home Assistant 的下拉选择实体触发场景：

```yaml
service: select.select_option
target:
  entity_id: select.your_device_name_notification_scene
data:
  option: "有人按门铃"
```

场景选项是一个下拉列表，包含所有可用的场景标题。

---

## 场景设置

进入 **设置** -> **通知**

| 设置项 | 说明 | 默认值 |
|--------|------|--------|
| 显示时长 | 通知显示多久 | 10秒 |
| 声音 | 显示时播放声音 | 开启 |
| 自定义场景 URL | 加载自定义场景的 URL | 空 |

---

## 自定义场景

你可以通过托管 JSON 文件来创建自己的场景。

### JSON 格式

自定义场景必须是 JSON 数组：

```json
[
  {
    "id": "my_scene",
    "icon": "fa-bell",
    "iconColor": "#fbbf24",
    "title": "我的场景",
    "desc": "描述文字",
    "subDesc": "副描述",
    "themeColors": ["#f59e0b", "#d97706", "#92400e"],
    "beamColor": "rgba(251, 191, 36, 0.8)",
    "dividerColor": "rgba(251, 191, 36, 0.8)",
    "dotColor": "#fcd34d"
  }
]
```

### 必填字段

| 字段 | 说明 |
|------|------|
| id | 唯一场景标识符 |
| icon | FontAwesome 图标名称（如 fa-bell） |
| title | 场景标题文字 |

### 可选字段

| 字段 | 说明 | 默认值 |
|------|------|--------|
| iconColor | 图标颜色（hex 或 Tailwind） | text-amber-200 |
| desc | 描述文字 | 空 |
| subDesc | 副描述文字 | 空 |
| themeColors | 主题颜色数组 | 琥珀色渐变 |
| beamColor | 光束颜色 | 琥珀色 |
| dividerColor | 分隔线颜色 | 琥珀色 |
| dotColor | 点指示器颜色 | 琥珀色 |

### 加载自定义场景

**方法一：使用外部 URL**
1. 将 JSON 文件托管在 Web 服务器上
2. 进入 **设置** -> **通知**
3. 在 **自定义场景 URL** 中输入 URL
4. 自定义场景的 ID 会自动添加 `custom_` 前缀

**方法二：使用 Home Assistant 本地文件**
1. 将 JSON 文件放到 Home Assistant 的 `www` 文件夹
2. 使用 URL：`http://your-ha-ip:8123/local/my_scenes.json`
3. 这样可以在本地网络内快速加载，无需外部服务器

---

## 自动化示例

### 门铃通知

```yaml
automation:
  - alias: "门铃通知"
    trigger:
      - platform: state
        entity_id: binary_sensor.doorbell
        to: "on"
    action:
      - service: select.select_option
        target:
          entity_id: select.ava_notification_scene
        data:
          option: "有人按门铃"
```

### 漏水警报

```yaml
automation:
  - alias: "漏水警报"
    trigger:
      - platform: state
        entity_id: binary_sensor.water_leak
        to: "on"
    action:
      - service: select.select_option
        target:
          entity_id: select.ava_notification_scene
        data:
          option: "漏水警报"
```

---

## 支持的颜色

Ava 支持多种颜色格式：

| 格式 | 示例 |
|------|------|
| Hex | #f59e0b |
| RGBA | rgba(251, 191, 36, 0.8) |
| Tailwind | amber-500, blue-400 等 |

### Tailwind 颜色名称

支持的颜色名称包括：
- amber, yellow, orange, red, rose, pink
- fuchsia, purple, violet, indigo, blue
- sky, cyan, teal, emerald, green, lime
- stone, neutral, gray, slate

每种颜色有级别：200, 300, 400, 500, 600, 700

---

## 常见问题

### 场景不加载？

1. 检查网络连接
2. 场景在启动时从 GitHub 下载
3. 尝试重启 Ava

### 自定义场景不显示？

1. 检查 URL 是否可访问
2. 验证 JSON 格式是否正确
3. 必填字段：id, icon, title
4. 自定义场景 ID 会添加 `custom_` 前缀

### 如何隐藏通知？

通知会在配置的时长后自动隐藏。你也可以：
- 触摸通知来关闭
- 使用隐藏服务

---

*返回 [首页](Home.md)*
